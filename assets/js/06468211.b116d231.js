"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[551],{9699:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>d});var s=i(4848),r=i(8453);const t={sidebar_position:4},c="View Instances",a={id:"main-system/view-manager/view-instances",title:"View Instances",description:"Once you have your View Template created, you can proceed to creating View Instance. As you already know, YOU as admin was required to create a View Template as it can be very dangerous to run unknown code and therefore u act as a supervisor here.",source:"@site/docs/main-system/view-manager/view-instances.md",sourceDirName:"main-system/view-manager",slug:"/main-system/view-manager/view-instances",permalink:"/storage-system-documentation/docs/main-system/view-manager/view-instances",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/main-system/view-manager/view-instances.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"mainSystemSidebar",previous:{title:"View Templates",permalink:"/storage-system-documentation/docs/main-system/view-manager/view-templates"},next:{title:"Setup",permalink:"/storage-system-documentation/docs/main-system/view-manager/setup"}},o={},d=[{value:"Creating a New View Instance",id:"creating-a-new-view-instance",level:3},{value:"Running View Instance",id:"running-view-instance",level:3},{value:"Getting View Instance Details",id:"getting-view-instance-details",level:3}];function l(e){const n={code:"code",em:"em",h1:"h1",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"view-instances",children:"View Instances"}),"\n",(0,s.jsxs)(n.p,{children:["Once you have your ",(0,s.jsx)(n.code,{children:"View Template"})," created, you can proceed to creating ",(0,s.jsx)(n.code,{children:"View Instance"}),". As you already know, YOU as admin was required to create a ",(0,s.jsx)(n.code,{children:"View Template"})," as it can be very dangerous to run unknown code and therefore u act as a supervisor here."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"View Instances"})," on the other hand, are created by apps. Therefore, when your app wants to create a new ",(0,s.jsx)(n.code,{children:"View Instance"}),", it needs to first give user a thorough plan for creating a new ",(0,s.jsx)(n.code,{children:"View Template"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"creating-a-new-view-instance",children:"Creating a New View Instance"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"/viewInstances/createNewViewInstance"})," ",(0,s.jsx)(n.em,{children:"(POST)"})]}),"\n",(0,s.jsxs)(n.p,{children:["When the app wants to create a new ",(0,s.jsx)(n.code,{children:"View Instance"}),", it needs to"]}),"\n",(0,s.jsx)(n.p,{children:"This is example request:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="Example New View Instance Request"',children:'{\r\n    "viewTemplateId": "660326e42f1d7be8fe0d6f2c",\r\n    "jwtTokenForPermissionRequestsAndProfiles": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6IjY1ZTllY2QxZGU0NzZlZTdiNGEyNzFjNyIsIm5hbWVEZWZpbmVkQnlVc2VyIjoiTXkgTmV3IEFwcCIsIm5hbWVEZWZpbmVkQnlBcHAiOiJhaG9qLmNvbSIsImlhdCI6MTcwOTgyOTM0NCwiZXhwIjoxMTE3NzEwOTM0NH0.i-laNiFOuY-u8U_AEi3wkq2Qhuj22gSLkgEfLx4UFhA",\r\n    "configuration": {\r\n        "from":"23.12.2020",\r\n        "to":"24.12.2026"\r\n    }\r\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Each ",(0,s.jsx)(n.code,{children:"View Template"})," contains a list of profiles with their respective rights. Individual ",(0,s.jsx)(n.code,{children:"View Instances"})," are meant to be utilising these sets of data corresponding to these profiles. Therefore, when the new ",(0,s.jsx)(n.code,{children:"View Instance"})," is created, ",(0,s.jsx)(n.code,{children:"View Manager"})," requests permissions for these profiles automatically in the ",(0,s.jsx)(n.code,{children:"Auth Service"}),". These permissions requests need to be approved by the admin user using the ",(0,s.jsx)(n.code,{children:"Auth Service"})," endpoints or using user interface in the form of ",(0,s.jsx)(n.code,{children:"Control Centre"})," frontend component."]}),"\n",(0,s.jsxs)(n.p,{children:["And this is response. Response shows which access tokens to profiles the view instance source code will get but most importantly, ",(0,s.jsx)(n.code,{children:"_id"})," of the newly created ",(0,s.jsx)(n.code,{children:"View Instance"})," is returned. This is the most important part of the response and the client app needs to remember this id for future execution of this source code."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="Example New View Instance Response For Initiated Request"',children:'{\r\n    "viewTemplate": "660326e42f1d7be8fe0d6f2c",\r\n    "accessTokensToProfiles": {\r\n        "CalendarPro.com_CalendarEventProfile": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhQWNjZXNzUGVybWlzc2lvbklkIjoiNjYwMzI5NmFjMzAyMGY4NzdjMWFiMTMxIiwiYXBwSWQiOiI2NWU5ZWNkMWRlNDc2ZWU3YjRhMjcxYzciLCJwZXJtaXNzaW9uIjp7InByb2ZpbGUiOiJDYWxlbmRhclByby5jb21fQ2FsZW5kYXJFdmVudFByb2ZpbGUiLCJyZWFkIjp0cnVlLCJjcmVhdGUiOnRydWUsIm1vZGlmeSI6ZmFsc2UsImRlbGV0ZSI6ZmFsc2V9LCJjcmVhdGVkRGF0ZSI6IjIwMjQtMDMtMjZUMjA6MDA6NDIuMjIyWiIsImFwcHJvdmVkRGF0ZSI6bnVsbCwiZXhwaXJhdGlvbkRhdGUiOm51bGwsImlhdCI6MTcxMTQ4MzI0MiwiZXhwIjoxMTE3ODc2MzI0Mn0.uNi8xA-GT3kDy70zaQVePiice6wL75hEJ1TbnMuCWik",\r\n        "app2.com/profile2": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhQWNjZXNzUGVybWlzc2lvbklkIjoiNjYwMzI5NmFjMzAyMGY4NzdjMWFiMTM1IiwiYXBwSWQiOiI2NWU5ZWNkMWRlNDc2ZWU3YjRhMjcxYzciLCJwZXJtaXNzaW9uIjp7InByb2ZpbGUiOiJhcHAyLmNvbS9wcm9maWxlMiIsInJlYWQiOnRydWUsImNyZWF0ZSI6dHJ1ZSwibW9kaWZ5Ijp0cnVlLCJkZWxldGUiOnRydWV9LCJjcmVhdGVkRGF0ZSI6IjIwMjQtMDMtMjZUMjA6MDA6NDIuMjU0WiIsImFwcHJvdmVkRGF0ZSI6bnVsbCwiZXhwaXJhdGlvbkRhdGUiOm51bGwsImlhdCI6MTcxMTQ4MzI0MiwiZXhwIjoxMTE3ODc2MzI0Mn0._cq8cmxtVfrmC3J2c6T9czY3b_zZ72Ji5EtgF49mZFA"\r\n    },\r\n    "configuration": {\r\n        "from": "23.12.2020",\r\n        "to": "24.12.2026"\r\n    },\r\n    // highlight-start\r\n    "_id": "6603296a2f1d7be8fe0d6f48",\r\n    // highlight-end\r\n    "createdDate": "2024-03-26T20:00:42.263Z",\r\n    "__v": 0\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"running-view-instance",children:"Running View Instance"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"/viewInstances/runViewInstance"})," ",(0,s.jsx)(n.em,{children:"(POST)"})]}),"\n",(0,s.jsxs)(n.p,{children:["This is example request: ",(0,s.jsx)(n.code,{children:"{{VIEW_MANAGER_URL}}/viewInstances/runViewInstance"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"This is example body:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'{\r\n    "viewInstanceId": "65fd8967a6ef77f149701be7",\r\n    "clientCustomData": {\r\n        "from": "this is from client data"\r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Your custom source code entry function, as mentioned in the source code requirements sections, needs to be able to receive exactly one parameter. This parameter is object containing the following:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"{ \r\n    accessTokensToProfiles: {}, // tokens for profiles \r\n    configuration: {...}, \r\n    clientCustomData: {...}, // this is the object from the request body\r\n    dataEndpoint: '...' // url for getting data \r\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This is what ",(0,s.jsx)(n.code,{children:"accessTokensToProfiles"})," object looks like (it is a normal object containing keys - names of the profiles)."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'"accessTokensToProfiles": {\r\n    "CalendarPro.com_CalendarEventProfile": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhQWNjZXNzUGVybWlzc2lvbklkIjoiNjYwMzI5NmFjMzAyMGY4NzdjMWFiMTMxIiwiYXBwSWQiOiI2NWU5ZWNkMWRlNDc2ZWU3YjRhMjcxYzciLCJwZXJtaXNzaW9uIjp7InByb2ZpbGUiOiJDYWxlbmRhclByby5jb21fQ2FsZW5kYXJFdmVudFByb2ZpbGUiLCJyZWFkIjp0cnVlLCJjcmVhdGUiOnRydWUsIm1vZGlmeSI6ZmFsc2UsImRlbGV0ZSI6ZmFsc2V9LCJjcmVhdGVkRGF0ZSI6IjIwMjQtMDMtMjZUMjA6MDA6NDIuMjIyWiIsImFwcHJvdmVkRGF0ZSI6bnVsbCwiZXhwaXJhdGlvbkRhdGUiOm51bGwsImlhdCI6MTcxMTQ4MzI0MiwiZXhwIjoxMTE3ODc2MzI0Mn0.uNi8xA-GT3kDy70zaQVePiice6wL75hEJ1TbnMuCWik",\r\n    "app2.com/profile2": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhQWNjZXNzUGVybWlzc2lvbklkIjoiNjYwMzI5NmFjMzAyMGY4NzdjMWFiMTM1IiwiYXBwSWQiOiI2NWU5ZWNkMWRlNDc2ZWU3YjRhMjcxYzciLCJwZXJtaXNzaW9uIjp7InByb2ZpbGUiOiJhcHAyLmNvbS9wcm9maWxlMiIsInJlYWQiOnRydWUsImNyZWF0ZSI6dHJ1ZSwibW9kaWZ5Ijp0cnVlLCJkZWxldGUiOnRydWV9LCJjcmVhdGVkRGF0ZSI6IjIwMjQtMDMtMjZUMjA6MDA6NDIuMjU0WiIsImFwcHJvdmVkRGF0ZSI6bnVsbCwiZXhwaXJhdGlvbkRhdGUiOm51bGwsImlhdCI6MTcxMTQ4MzI0MiwiZXhwIjoxMTE3ODc2MzI0Mn0._cq8cmxtVfrmC3J2c6T9czY3b_zZ72Ji5EtgF49mZFA"\r\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"This is example response:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="Execution Result Response (200)"',children:'{\r\n    "message": "Source code successfully executed",\r\n    "result": {} // whatever your source code returns ( look at source code requirements here in View Manager module)\r\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["There may be other response codes in case something goes wrong. In every error response, it is ensured that you get ",(0,s.jsx)(n.code,{children:"message"})," about what went wrong."]}),"\n",(0,s.jsx)(n.h3,{id:"getting-view-instance-details",children:"Getting View Instance Details"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["/viewInstances/",":viewInstanceId"]})," ",(0,s.jsx)(n.em,{children:"(GET)"})]}),"\n",(0,s.jsxs)(n.p,{children:["To get details about a given ",(0,s.jsx)(n.code,{children:"View Instance"}),", this endpoint does exactly that."]}),"\n",(0,s.jsxs)(n.p,{children:["This is example request ",(0,s.jsx)(n.code,{children:"{{VIEW_MANAGER_URL}}/viewInstances/6603296a2f1d7be8fe0d6f48"})]}),"\n",(0,s.jsx)(n.p,{children:"and this object is returned:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'{\r\n    "_id": "6603296a2f1d7be8fe0d6f48",\r\n    "viewTemplate": {\r\n        "_id": "660326e42f1d7be8fe0d6f2c",\r\n        "templateName": "First Demo Template",\r\n        "sourceCodeId": "7b7e47d1-ecd5-4bfe-9e5c-4e58ade51a9e",\r\n        "metadata": {\r\n            "runtime": "javascript"\r\n        },\r\n        "profiles": [\r\n            {\r\n                "profile": "CalendarPro.com_CalendarEventProfile",\r\n                "read": true,\r\n                "create": true,\r\n                "modify": false,\r\n                "delete": false,\r\n                "_id": "660326e42f1d7be8fe0d6f2d"\r\n            },\r\n            {\r\n                "profile": "app2.com/profile2",\r\n                "read": true,\r\n                "create": true,\r\n                "modify": true,\r\n                "delete": true,\r\n                "_id": "660326e42f1d7be8fe0d6f2e"\r\n            }\r\n        ],\r\n        "createdDate": "2024-03-26T19:49:56.213Z",\r\n        "__v": 0\r\n    },\r\n    "accessTokensToProfiles": {\r\n        "CalendarPro.com_CalendarEventProfile": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhQWNjZXNzUGVybWlzc2lvbklkIjoiNjYwMzI5NmFjMzAyMGY4NzdjMWFiMTMxIiwiYXBwSWQiOiI2NWU5ZWNkMWRlNDc2ZWU3YjRhMjcxYzciLCJwZXJtaXNzaW9uIjp7InByb2ZpbGUiOiJDYWxlbmRhclByby5jb21fQ2FsZW5kYXJFdmVudFByb2ZpbGUiLCJyZWFkIjp0cnVlLCJjcmVhdGUiOnRydWUsIm1vZGlmeSI6ZmFsc2UsImRlbGV0ZSI6ZmFsc2V9LCJjcmVhdGVkRGF0ZSI6IjIwMjQtMDMtMjZUMjA6MDA6NDIuMjIyWiIsImFwcHJvdmVkRGF0ZSI6bnVsbCwiZXhwaXJhdGlvbkRhdGUiOm51bGwsImlhdCI6MTcxMTQ4MzI0MiwiZXhwIjoxMTE3ODc2MzI0Mn0.uNi8xA-GT3kDy70zaQVePiice6wL75hEJ1TbnMuCWik",\r\n        "app2.com/profile2": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhQWNjZXNzUGVybWlzc2lvbklkIjoiNjYwMzI5NmFjMzAyMGY4NzdjMWFiMTM1IiwiYXBwSWQiOiI2NWU5ZWNkMWRlNDc2ZWU3YjRhMjcxYzciLCJwZXJtaXNzaW9uIjp7InByb2ZpbGUiOiJhcHAyLmNvbS9wcm9maWxlMiIsInJlYWQiOnRydWUsImNyZWF0ZSI6dHJ1ZSwibW9kaWZ5Ijp0cnVlLCJkZWxldGUiOnRydWV9LCJjcmVhdGVkRGF0ZSI6IjIwMjQtMDMtMjZUMjA6MDA6NDIuMjU0WiIsImFwcHJvdmVkRGF0ZSI6bnVsbCwiZXhwaXJhdGlvbkRhdGUiOm51bGwsImlhdCI6MTcxMTQ4MzI0MiwiZXhwIjoxMTE3ODc2MzI0Mn0._cq8cmxtVfrmC3J2c6T9czY3b_zZ72Ji5EtgF49mZFA"\r\n    },\r\n    "configuration": {\r\n        "from": "23.12.2020",\r\n        "to": "24.12.2026"\r\n    },\r\n    "createdDate": "2024-03-26T20:00:42.263Z",\r\n    "__v": 0\r\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["In case the ",(0,s.jsx)(n.code,{children:"View Instance"})," is not found, ",(0,s.jsx)(n.code,{children:"400"})," is returned along with a message."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="404 Not Found"',children:"{\r\n    \"message\": 'View Instance not found'\r\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>a});var s=i(6540);const r={},t=s.createContext(r);function c(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);