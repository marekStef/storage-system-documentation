"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[1083],{7621:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var t=i(4848),s=i(8453);const r={sidebar_position:0},a="Activity Tracker App",o={id:"example-apps/activity-tracker/walkthrough",title:"Activity Tracker App",description:"Introduction",source:"@site/docs/example-apps/activity-tracker/walkthrough.md",sourceDirName:"example-apps/activity-tracker",slug:"/example-apps/activity-tracker/walkthrough",permalink:"/storageSystemDocs/docs/example-apps/activity-tracker/walkthrough",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/example-apps/activity-tracker/walkthrough.md",tags:[],version:"current",sidebarPosition:0,frontMatter:{sidebar_position:0},sidebar:"exampleAppsSidebar",previous:{title:"Activity Tracker",permalink:"/storageSystemDocs/docs/category/activity-tracker"}},c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Being able to run in the background without a visible window and no icon in the taskbar",id:"being-able-to-run-in-the-background-without-a-visible-window-and-no-icon-in-the-taskbar",level:4},{value:"Gathering Windows Apps Info",id:"gathering-windows-apps-info",level:4},{value:"Gathering Screenshots",id:"gathering-screenshots",level:4},{value:"Logging Key Presses",id:"logging-key-presses",level:4},{value:"Gathering Network Info",id:"gathering-network-info",level:4},{value:"Automatic Startup During Startup of the Windows OS",id:"automatic-startup-during-startup-of-the-windows-os",level:4},{value:"Walkthrough",id:"walkthrough",level:2},{value:"Initial Setup Page",id:"initial-setup-page",level:3},{value:"Existing Setup Page",id:"existing-setup-page",level:3},{value:"Home Page",id:"home-page",level:3},{value:"Settings Page",id:"settings-page",level:3}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"activity-tracker-app",children:"Activity Tracker App"}),"\n",(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(n.p,{children:["This ",(0,t.jsx)(n.strong,{children:"Windows Activity Tracker App"})," was programmed in C++ programmig language and is primary targeted at ",(0,t.jsx)(n.strong,{children:"Windows Operating System"}),".\r\nIt consists of GUI and tracking related business logic using Windows specific APIs."]}),"\n",(0,t.jsxs)(n.p,{children:["We chose ",(0,t.jsx)(n.strong,{children:"wxWidgets"})," for writing the UI part. ",(0,t.jsx)(n.strong,{children:"wxWidgets"})," is an open-source, cross-platform graphical user interface toolkit that allows developers to create applications with native look and feel on Windows, macOS, Linux, and other operating systems using C++."]}),"\n",(0,t.jsx)(n.p,{children:"Even though the GUI could possibly run on other systems than Windows, it's the heavy use of Windows specific things that restricts the use of this application elsewhere."}),"\n",(0,t.jsx)(n.p,{children:"As for the functionality, this is the current set of features:"}),"\n",(0,t.jsx)(n.h4,{id:"being-able-to-run-in-the-background-without-a-visible-window-and-no-icon-in-the-taskbar",children:"Being able to run in the background without a visible window and no icon in the taskbar"}),"\n",(0,t.jsx)(n.p,{children:"When the application starts, it shows a GUI window containing various pages. User can start different services (which we talk about later) and close the app by either clicking on the minimise button or even a close button. When either of those buttons is clicked, the application hides the main GUI window, including the icon with a title in the task bar and moves to the system tray. It's only in the system tray where the user can bring the main UI back from. User also receives one-time popup alert explaining where to find this hiddne app."}),"\n",(0,t.jsx)(n.p,{children:"Application is therefore able to run silently, not disturbing the user at all."}),"\n",(0,t.jsx)(n.h4,{id:"gathering-windows-apps-info",children:"Gathering Windows Apps Info"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Windows Activity Tracker"})," periodicly gathers data about each individual running visible window app (excludes non-GUI applications)."]}),"\n",(0,t.jsx)(n.p,{children:"This set of applications data is then transformed into JSON and stored as a json file in predefined directory. This directory is chosen in the settings screen.\r\nUser can set periodicity of this information gathering and start the gathering thread from the home screen of the app."}),"\n",(0,t.jsx)(n.p,{children:"This is what such a json file looks like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="Windows Apps Info Data"',children:'[\r\n    {\r\n        "metadata": {\r\n            "createdDate": "2024-04-16T17:50:48.486Z",\r\n            "profile": "activityTracker.com/activityTrackerEvent"\r\n        },\r\n        "payload": {\r\n            "dimensions": {\r\n                "bottom": -31972,\r\n                "left": -32000,\r\n                "right": -31840,\r\n                "top": -32000\r\n            },\r\n            "exeName": "C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Enterprise\\\\Common7\\\\IDE\\\\devenv.exe",\r\n            "isMinimised": true,\r\n            "memoryUsageInBytes": "852729856",\r\n            "moduleName": "devenv.exe",\r\n            "processId": "3435973836",\r\n            "title": "activityTracker (Running) - Microsoft Visual Studio"\r\n        }\r\n    },\r\n    {\r\n        "metadata": {\r\n            "createdDate": "2024-04-16T17:50:48.486Z",\r\n            "profile": "activityTracker.com/activityTrackerEvent"\r\n        },\r\n        "payload": {\r\n            "dimensions": {\r\n                "bottom": -31972,\r\n                "left": -32000,\r\n                "right": -31840,\r\n                "top": -32000\r\n            },\r\n            "exeName": "C:\\\\Windows\\\\explorer.exe",\r\n            "isMinimised": true,\r\n            "memoryUsageInBytes": "411336704",\r\n            "moduleName": "Explorer.EXE",\r\n            "processId": "3435973836",\r\n            "title": "2024-04-16_T17-45-31.757Z"\r\n        }\r\n    },\r\n    {\r\n        "metadata": {\r\n            "createdDate": "2024-04-16T17:50:48.486Z",\r\n            "profile": "activityTracker.com/activityTrackerEvent"\r\n        },\r\n        "payload": {\r\n            "dimensions": {\r\n                "bottom": -31972,\r\n                "left": -32000,\r\n                "right": -31840,\r\n                "top": -32000\r\n            },\r\n            "exeName": "C:\\\\Program Files (x86)\\\\Microsoft Office\\\\root\\\\Office16\\\\OUTLOOK.EXE",\r\n            "isMinimised": true,\r\n            "memoryUsageInBytes": "232927232",\r\n            "moduleName": "OUTLOOK.EXE",\r\n            "processId": "3435973836",\r\n            "title": "Sent Items - stefanecmarek@icloud.com - Outlook"\r\n        }\r\n    },\r\n    {\r\n        "metadata": {\r\n            "createdDate": "2024-04-16T17:50:48.486Z",\r\n            "profile": "activityTracker.com/activityTrackerEvent"\r\n        },\r\n        "payload": {\r\n            "dimensions": {\r\n                "bottom": -31972,\r\n                "left": -32000,\r\n                "right": -31840,\r\n                "top": -32000\r\n            },\r\n            "exeName": "C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe",\r\n            "isMinimised": true,\r\n            "memoryUsageInBytes": "505491456",\r\n            "moduleName": "",\r\n            "processId": "3435973836",\r\n            "title": "Alza.sk - Google Chrome"\r\n        }\r\n    },\r\n]\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Windows Activity Tracker"})," also tries to synchronise these data with the main storage system. That's why the app also contains logic for associating itself with the storage system, including creating new profiles, requesting permissions and individual events uploading."]}),"\n",(0,t.jsxs)(n.p,{children:["For getting this data, we primarily depend on ",(0,t.jsx)(n.code,{children:"windows.h"})," and ",(0,t.jsx)(n.code,{children:"psapi.h"})," libraries."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"EnumWindows"})," function from ",(0,t.jsx)(n.code,{children:"windows.h"})," is a cornerstone of this application, as it allows us to enumerate through all open windows and collect information such as window titles, class names, dimensions, and state (minimized or not). This function calls the ",(0,t.jsx)(n.code,{children:"EnumWindowsProc"})," callback which captures detailed attributes for each window including process ID, executable name, and memory usage\u2014attributes that are crucial for analyzing the applications running on a system."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"psapi.h"})," library's functions like ",(0,t.jsx)(n.code,{children:"GetProcessMemoryInfo"})," and ",(0,t.jsx)(n.code,{children:"GetModuleFileNameEx"})," are used to enrich the information captured by retrieving the memory usage statistics of the given process and the executable path of the application running in the window."]}),"\n",(0,t.jsx)(n.h4,{id:"gathering-screenshots",children:"Gathering Screenshots"}),"\n",(0,t.jsx)(n.p,{children:"The application takes screenshots of all currently connected active monitors. It detects them, adjusts picture properties for them and takes screenshots. Eaching screenshotting moment is then stored in a new directory named according to the current time and consisting of all pictures of monitors. Directory for these screenshots is as well selected in the app's settings page."}),"\n",(0,t.jsx)(n.p,{children:"These screenshots are currently not synced."}),"\n",(0,t.jsxs)(n.p,{children:["For taking screenshots, we created a ",(0,t.jsx)(n.code,{children:"Screenshots Manager"}),". This depends on ",(0,t.jsx)(n.code,{children:"windows.h"})," and ",(0,t.jsx)(n.code,{children:"gdiplus.h"})," libraries."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"gdiplus.h"})," is part of the ",(0,t.jsx)(n.code,{children:"GDI+"})," library, an enhancement over the older GDI framework, providing more complex two-dimensional graphics and imaging capabilities. This library is crucial for handling the images captured from the screen. It supports operations like loading, saving, processing, and manipulating images in various formats. In our application, ",(0,t.jsx)(n.code,{children:"GDI+"})," functions are used to save the captured bitmap images into desired formats using specific codecs. Functions such as ",(0,t.jsx)(n.code,{children:"Gdiplus::Bitmap::Save"})," and ",(0,t.jsx)(n.code,{children:"Gdiplus::GetImageEncoders"})," are used for managing image files, enabling the application to handle image data efficiently and with high fidelity."]}),"\n",(0,t.jsxs)(n.p,{children:["In the screenshot management functionality, ",(0,t.jsx)(n.code,{children:"windows.h"})," and ",(0,t.jsx)(n.code,{children:"gdiplus.h"})," work in tandem to perform the task of capturing and saving screenshots:"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Screen Capture with windows.h:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"GetDC"})," function retrieves a handle to a device context for the entire screen, which represents a drawing surface for the Windows display."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"CreateCompatibleDC"})," and ",(0,t.jsx)(n.code,{children:"CreateCompatibleBitmap"})," create a memory device context and bitmap that are compatible with the screen. This is where the screenshot will be drawn."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"BitBlt"})," transfers the bitmap data from the screen's device context to the bitmap stored in memory, effectively capturing the screenshot.\r\n",(0,t.jsx)(n.strong,{children:"Image Saving with gdiplus.h:"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Upon capturing the bitmap, ",(0,t.jsx)(n.code,{children:"GDI+"})," is utilized to convert and save this bitmap into a file. The ",(0,t.jsx)(n.code,{children:"Gdiplus::Bitmap"})," object represents the image in memory.\r\nEncoder CLSIDs (Class Identifiers) are retrieved using GetImageEncoders, which are necessary for specifying the format in which the image should be saved (e.g., JPEG, PNG).\r\nThe Save method of the ",(0,t.jsx)(n.code,{children:"Gdiplus::Bitmap"})," class is used to write the image file to disk in the desired format, utilizing the previously obtained encoder."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"logging-key-presses",children:"Logging Key Presses"}),"\n",(0,t.jsxs)(n.p,{children:["This feature heavily depends on the app's ability to hide itself. That's because this logging of key presses on the user's keyboard is handled by another thread and the logging works even when the apps is not focused, nor shown. In other words, any key press anywhere in the system is registered and saved in the file. When the user starts this key presses logging a new file is created for this session and stored in a predefined directory (selected in the settings). Inside this directory, another directory called ",(0,t.jsx)(n.code,{children:"keypresses"})," gets created where these files are stored."]}),"\n",(0,t.jsxs)(n.p,{children:["This functionality depends again on ",(0,t.jsx)(n.code,{children:"windows.h"})," library."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"SetWindowsHookEx"}),": This function installs an application-defined hook procedure into a hook chain. In our code, it's used to install a low-level keyboard hook (",(0,t.jsx)(n.code,{children:"WH_KEYBOARD_LL"}),") that monitors keystroke messages."]}),"\n",(0,t.jsxs)(n.li,{children:["The callback function ",(0,t.jsx)(n.code,{children:"lowLevelKeyboardPressCallback"})," defined is registered and gets called by the Windows system every time a keyboard event occurs. It checks whether the event should be processed (nCode == HC_ACTION) and logs key presses based on whether the Ctrl or Shift key is held down along with another key."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"UnhookWindowsHookEx"}),": This function removes a previously installed hook procedure from a hook chain. It is used to deactivate the keyboard hook when it is no longer needed, ensuring that the application cleans up its resources correctly."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"gathering-network-info",children:"Gathering Network Info"}),"\n",(0,t.jsx)(n.p,{children:"This part of the app allows scanning and retrieving the SSIDs of available WLAN networks."}),"\n",(0,t.jsx)(n.p,{children:"There are several key libraries integral to this functionality:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Wlanapi.h"}),"\r\nThis header file is part of the Windows Native Wi-Fi API, which provides functions to interact with WLAN (Wireless Local Area Network) interfaces."]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Windows.h"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["From ",(0,t.jsx)(n.code,{children:"Wlanapi.h"})," we use the following functions:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WlanOpenHandle()"}),": Opens a client handle to the WLAN service, which is required for other WLAN operations."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WlanEnumInterfaces()"}),": Enumerates all WLAN interfaces on the device, providing information about each interface."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WlanGetAvailableNetworkList()"}),": Retrieves a list of available networks for a specific WLAN interface."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WlanFreeMemory()"}),": Frees memory that was allocated by WLAN API functions like ",(0,t.jsx)(n.code,{children:"WlanEnumInterfaces"})," and ",(0,t.jsx)(n.code,{children:"WlanGetAvailableNetworkList"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"WlanCloseHandle()"}),": Closes the handle obtained by ",(0,t.jsx)(n.code,{children:"WlanOpenHandle"})," once WLAN operations are complete."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"These functions are specifically designed for managing and retrieving information about wireless network interfaces and networks available to these interfaces. They enable applications to interact with the hardware's wireless capabilities at a system level."}),"\n",(0,t.jsx)(n.h4,{id:"automatic-startup-during-startup-of-the-windows-os",children:"Automatic Startup During Startup of the Windows OS"}),"\n",(0,t.jsx)(n.p,{children:"Application has the ability to register itself among the list of apps which are started during the startup of the operating system. This can be turned off in the app's settings."}),"\n",(0,t.jsx)(n.h2,{id:"walkthrough",children:"Walkthrough"}),"\n",(0,t.jsx)(n.h3,{id:"initial-setup-page",children:"Initial Setup Page"}),"\n",(0,t.jsx)(n.p,{children:"This screen is meant for setting up with the main storage system. That's because as we already mentioned, the app synchronises the windows apps info data."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Windows Activity Tracker - Initial Setup",src:i(7434).A+"",width:"604",height:"556"})}),"\n",(0,t.jsx)(n.p,{children:"Input becomes green, when it's been checked and it's correct. When the setup is successfull, these inputs disappear and the information about the app being setup is displayed."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Windows Activity Tracker - Initial Setup Already Set",src:i(8180).A+"",width:"611",height:"113"})}),"\n",(0,t.jsx)(n.h3,{id:"existing-setup-page",children:"Existing Setup Page"}),"\n",(0,t.jsx)(n.p,{children:"If there exists some already existing setup in the main storage system, the user can just copy proper tokens and paste them here."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Windows Activity Tracker - Existing Setup",src:i(1763).A+"",width:"607",height:"452"})}),"\n",(0,t.jsx)(n.h3,{id:"home-page",children:"Home Page"}),"\n",(0,t.jsx)(n.p,{children:"This is the place where magic happens - user can start all aforementioned features here."}),"\n",(0,t.jsx)(n.p,{children:"Also, as you can see, currently connected to network SSIDs are shown."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Windows Activity Tracker - Home Screen",src:i(8805).A+"",width:"601",height:"542"})}),"\n",(0,t.jsx)(n.h3,{id:"settings-page",children:"Settings Page"}),"\n",(0,t.jsx)(n.p,{children:"This is the page where the user can set the directory where all data will be stored - including the windows apps info, screenshots and key presses. All this data won't be mixed up though - everything will be neatly placed in nested directories."}),"\n",(0,t.jsx)(n.p,{children:"Periodicity (in seconds) can be set for taking screenshots and windows apps info gathering."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Windows Activity Tracker - Home Screen",src:i(3255).A+"",width:"606",height:"547"})}),"\n",(0,t.jsx)(n.p,{children:"Last, but not least, the app can be reset from this place."})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},1763:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/existing-setup-5a6269b09742c891a4c055659dbf10e5.png"},8805:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/home-944b69c031173623f94cc52a28fb7431.png"},8180:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/initial-setup-app-already-set-7855001e29259fc96cc13b287ee32fcc.png"},7434:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/initial-setup-e2581b0e0f0d3e1c6af9bc8467670907.png"},3255:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/settings-fc0219372b52c97a106fa7a694a0d218.png"},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var t=i(6540);const s={},r=t.createContext(s);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);