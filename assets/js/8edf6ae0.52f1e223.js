"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[9092],{5108:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var t=r(4848),s=r(8453);const o={sidebar_position:2},a="Requirements On Source Code",i={id:"main-system/view-manager/requirements-on-source-code",title:"Requirements On Source Code",description:"View Manager component is independent of any specific source code language. It depends on other other execution services such as Javascript Execution Service or Python Execution Service.",source:"@site/docs/main-system/view-manager/requirements-on-source-code.md",sourceDirName:"main-system/view-manager",slug:"/main-system/view-manager/requirements-on-source-code",permalink:"/storageSystemDocs/docs/main-system/view-manager/requirements-on-source-code",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/main-system/view-manager/requirements-on-source-code.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"mainSystemSidebar",previous:{title:"Schemas",permalink:"/storageSystemDocs/docs/main-system/view-manager/schemas"},next:{title:"View Templates",permalink:"/storageSystemDocs/docs/main-system/view-manager/view-templates"}},c={},d=[{value:"Requirements For Javascript Code",id:"requirements-for-javascript-code",level:3},{value:"Examples",id:"examples",level:3}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"requirements-on-source-code",children:"Requirements On Source Code"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"View Manager"})," component is independent of any specific source code language. It depends on other other execution services such as ",(0,t.jsx)(n.code,{children:"Javascript Execution Service"})," or ",(0,t.jsx)(n.code,{children:"Python Execution Service"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Requirements mentioned here are general and valid for all execution services."}),"\n",(0,t.jsxs)(n.p,{children:["However, it is crucial to recognize that while these general requirements provide a solid framework, each execution service introduces its own set of additional, specific requirements. These nuanced requirements are tailored to the unique characteristics and capabilities of the respective execution service, addressing aspects such as language-specific conventions. It's of high importance for you to read those as well if you are about to develop new block of source code for a new ",(0,t.jsx)(n.code,{children:"View Template"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"requirements-for-javascript-code",children:"Requirements For Javascript Code"}),"\n",(0,t.jsxs)(n.p,{children:["To look at the requirements for javascript code, go to ",(0,t.jsx)(n.code,{children:"Javascript Execution Service"})," requirements for source code."]}),"\n",(0,t.jsx)(n.p,{children:"As for the entry point function arguments in case of javascript, it needs to have exactly one object."}),"\n",(0,t.jsx)(n.p,{children:"This argument is an object looking like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="JS Entry Point Function Parameter Object Structure"',children:"{ \r\n    accessTokensToProfiles: {}, // tokens for profiles \r\n    configuration: {...}, \r\n    clientCustomData: {...}, // this is the object from the request body\r\n    dataEndpoint: '...' // url for getting data \r\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,t.jsxs)(n.p,{children:["This is the ",(0,t.jsx)(n.code,{children:"View Template"})," source code of the ",(0,t.jsx)(n.code,{children:"CalendarPro"})," app:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="main.js"',children:"const { get, isDateWithinInterval } = require('./helpers');\r\n\r\nconst CHECK_ACCESS_TOKEN_STATUS = '/app/api/checkAccessTokenStatus';\r\nconst GET_ALL_EVENTS_FOR_GIVEN_ACCESS_TOKEN = '/app/api/getAllEventsForGivenAccessToken';\r\n\r\nconst isAccessTokenActive = (endpoint, accessToken) => {\r\n    return new Promise((res, rej) => {\r\n        get(`${endpoint}${CHECK_ACCESS_TOKEN_STATUS}?accessToken=${accessToken}`)\r\n            .then(response => {\r\n                res(response.isActive);\r\n            })\r\n            .catch(errResponse => {\r\n                rej(false);\r\n            })\r\n    })\r\n}\r\n\r\nconst getAllCalendarEvents = (endpoint, tokenForCalendarEvents) => {\r\n    return new Promise(async (res, rej) => {\r\n        try {\r\n            const response = await get(`${endpoint}${GET_ALL_EVENTS_FOR_GIVEN_ACCESS_TOKEN}`, {\r\n                accessToken: tokenForCalendarEvents\r\n            });\r\n\r\n            res({\r\n                ...response,\r\n            });\r\n        } catch (error) {\r\n            console.error('Error getting calendar events:', error);\r\n            rej(`Error getting calendar events: ${error.message ?? 'Server not reachable probably'}`);\r\n        }\r\n    }) \r\n}\r\n\r\nconst mainFunction = (parametersObject) => {\r\n    return new Promise(async (res, rej) => {\r\n\r\n        const { accessTokensToProfiles, configuration, clientCustomData, dataEndpoint } = parametersObject;\r\n\r\n        const tokenForCalendarEvents = accessTokensToProfiles[\"CalendarPro.com_CalendarEventProfile\"];\r\n\r\n        const isAccessTokenActivated = await isAccessTokenActive(dataEndpoint, tokenForCalendarEvents);\r\n\r\n        // return res({isAccessTokenActivated, tokenForCalendarEvents, dataEndpoint, a: `${dataEndpoint}/app/api/checkAccessTokenStatus?accessToken=${tokenForCalendarEvents}`})\r\n\r\n        if (!isAccessTokenActivated) {\r\n            return res({\r\n                code: 400,\r\n                message: 'Access Token is not active!'\r\n            })\r\n        }\r\n\r\n        getAllCalendarEvents(dataEndpoint, tokenForCalendarEvents)\r\n            .then(response => {\r\n                const intervalStartTime = clientCustomData.selectedWeek.startOfWeek;\r\n                const intervalEndTime = clientCustomData.selectedWeek.endOfWeek;\r\n\r\n                const filteredEvents = response.events.filter(event => isDateWithinInterval(event.payload.startTime, intervalStartTime, intervalEndTime));\r\n\r\n                res({\r\n                    code: 200,\r\n                    message: 'Events loaded successfully',\r\n                    response,\r\n                    clientCustomData,\r\n                    filteredEvents\r\n                })\r\n            })\r\n            .catch(err => {\r\n                res({\r\n                    code: 500,\r\n                    message: 'Something went wrong when requesting events'\r\n                })\r\n            });\r\n    })\r\n}\r\n\r\nmodule.exports = mainFunction;\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="helpers.js"',children:"const get = (endpoint, queryParams) => {\r\n    const toQueryString = (params) => {\r\n        return Object.keys(params)\r\n            .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`)\r\n            .join('&');\r\n    };\r\n\r\n    const queryString = queryParams ? `?${toQueryString(queryParams)}` : '';\r\n    \r\n    return new Promise((res, rej) => {\r\n        fetch(`${endpoint}${queryString}`)\r\n            .then(response => response.json().then(body => response.ok ? res({...body, status: response.status}) : rej({...body, status: response.status})))\r\n            .catch(error => rej(error));\r\n    });\r\n}\r\n\r\nfunction isDateWithinInterval(dateToCheckStr, startDateStr, endDateStr) {\r\n    const checkDate = new Date(dateToCheckStr).getTime();\r\n    const start = new Date(startDateStr).getTime();\r\n    const end = new Date(endDateStr).getTime();\r\n\r\n    return checkDate >= start && checkDate <= end;\r\n}\r\n\r\n\r\nmodule.exports = {\r\n    get,\r\n    isDateWithinInterval\r\n}\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["As you can see, the names of those javascript source code files are important as they can be imported. Therefore, when you create new ",(0,t.jsx)(n.code,{children:"View Template"}),", you need to be absolutely sure that the names of those files are kept according to originals. Uploading ",(0,t.jsx)(n.code,{children:"helpers(1).js"})," or ",(0,t.jsx)(n.code,{children:"helpers - Copy.js"})," won't work!"]})}),"\n",(0,t.jsx)(n.p,{children:"Now that you know what requirements on the source code are, you can start creating your own!"})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>i});var t=r(6540);const s={},o=t.createContext(s);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);